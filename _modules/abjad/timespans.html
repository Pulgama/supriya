

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>abjad.timespans &mdash; Supriya 0.3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/uqbar.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Supriya
          

          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts.html">Core concepts</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../realtime/index.html">Real-time composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../synthdefs/index.html">Synth definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nonrealtime.html">Non-realtime composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../patterns.html">Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../osc.html">OSC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../midi.html">MIDI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Live performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">CLI tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/samplers.html">Samplers</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/supriya/index.html">supriya</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev/documenation.html">Sphinx &amp; IPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/travisci.html">Travis-CI</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Supriya</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>abjad.timespans</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for abjad.timespans</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">abjad</span> <span class="k">import</span> <span class="n">enums</span>
<span class="kn">from</span> <span class="nn">abjad.markups</span> <span class="k">import</span> <span class="n">Markup</span>
<span class="kn">from</span> <span class="nn">abjad.markups</span> <span class="k">import</span> <span class="n">Postscript</span>
<span class="kn">from</span> <span class="nn">abjad</span> <span class="k">import</span> <span class="n">mathtools</span>
<span class="kn">from</span> <span class="nn">abjad.mathtools</span> <span class="k">import</span> <span class="n">Ratio</span>
<span class="kn">from</span> <span class="nn">abjad.system.FormatSpecification</span> <span class="k">import</span> <span class="n">FormatSpecification</span>
<span class="kn">from</span> <span class="nn">abjad.system.Signature</span> <span class="k">import</span> <span class="n">Signature</span>
<span class="kn">from</span> <span class="nn">abjad.system.StorageFormatManager</span> <span class="k">import</span> <span class="n">StorageFormatManager</span>
<span class="kn">from</span> <span class="nn">abjad.top.new</span> <span class="k">import</span> <span class="n">new</span>
<span class="kn">from</span> <span class="nn">abjad.utilities</span> <span class="k">import</span> <span class="n">Infinity</span>
<span class="kn">from</span> <span class="nn">abjad.utilities</span> <span class="k">import</span> <span class="n">NegativeInfinity</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.Duration</span> <span class="k">import</span> <span class="n">Duration</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.Expression</span> <span class="k">import</span> <span class="n">Expression</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.Multiplier</span> <span class="k">import</span> <span class="n">Multiplier</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.Offset</span> <span class="k">import</span> <span class="n">Offset</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.Sequence</span> <span class="k">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">abjad.utilities.TypedList</span> <span class="k">import</span> <span class="n">TypedList</span>


<span class="k">class</span> <span class="nc">Timespan</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Timespan.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">        &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">        &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">        &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">    Timespans are closed-open intervals.</span>

<span class="sd">    Timespans are immutable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Timespans&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_expression&quot;</span><span class="p">,</span> <span class="s2">&quot;_start_offset&quot;</span><span class="p">,</span> <span class="s2">&quot;_stop_offset&quot;</span><span class="p">)</span>

    <span class="n">_publish_storage_format</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">Infinity</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;can not initialize from timespan.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;can not initialize from timespan.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start_offset</span> <span class="o">=</span> <span class="n">NegativeInfinity</span>
        <span class="k">if</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">Infinity</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">stop_offset</span><span class="p">,</span> <span class="nb">repr</span><span class="p">((</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">=</span> <span class="n">start_offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical AND of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_2</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(5, 1), stop_offset=Offset(10, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_3</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(0, 1), stop_offset=Offset(2, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &amp; timespan_3</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &amp; timespan_4</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(10, 1), stop_offset=Offset(12, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 &amp; timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">TimespanList</span><span class="p">([</span><span class="n">timespan</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan contains ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Works with offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, (1, 4))</span>

<span class="sd">            &gt;&gt;&gt; -1 in timespan</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; 0 in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; Offset(1, 8) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; Offset(1, 4) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; Offset(1, 2) in timespan</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Works with other timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, (1, 4))</span>

<span class="sd">            &gt;&gt;&gt; abjad.timespan(0, (1, 4)) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.timespan((1, 16), (2, 16)) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.timespan(0, (1, 2)) in timespan</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">argument</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_timespan_improperly</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is a timespan with equal offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(1, 3) == abjad.Timespan(1, 3)</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(1, 3) == abjad.Timespan(2, 3)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="o">.</span><span class="n">compare_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__format__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_specification</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Formats timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(timespan)</span>
<span class="sd">            abjad.Timespan(</span>
<span class="sd">                start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                )</span>

<span class="sd">        Returns string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">format_specification</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;storage&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_storage_format</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is greater or equal</span>
<span class="sd">        to timespan start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &gt;= timespan_3</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &gt;= timespan_2</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&gt;=</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&gt;=</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&gt;=</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is greater than</span>
<span class="sd">        timespan start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &gt; timespan_3</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &gt; timespan_2</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&gt;</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&gt;</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&gt;</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes timespan.</span>

<span class="sd">        Required to be explicitly redefined on Python 3 if __eq__ changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__illustrate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">range_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Illustrates timespan.</span>

<span class="sd">        Returns LilyPond file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">timespans</span><span class="o">.</span><span class="n">__illustrate__</span><span class="p">(</span><span class="n">range_</span><span class="o">=</span><span class="n">range_</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is less than or equal to</span>
<span class="sd">        timespan start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &lt;= timespan_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &lt;= timespan_2</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defined equal to ``1`` for all timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; len(timespan)</span>
<span class="sd">            1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is less than timespan start</span>
<span class="sd">        offset.</span>

<span class="sd">        ..  container::: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &lt; timespan_2</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &lt; timespan_3</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical OR of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 | timespan_2</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 | timespan_3</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_2 | timespan_3</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_2 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_3 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tangent_to_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">])</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">TimespanList</span><span class="p">([</span><span class="n">timespan</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subtract ``argument`` from timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_1</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(0, 1), stop_offset=Offset(5, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(2, 1), stop_offset=Offset(10, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(0, 1), stop_offset=Offset(10, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(10, 1), stop_offset=Offset(12, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_2</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(5, 1), stop_offset=Offset(12, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(5, 1), stop_offset=Offset(10, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_3</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(-2, 1), stop_offset=Offset(0, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(-2, 1), stop_offset=Offset(2, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(-2, 1), stop_offset=Offset(2, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(10, 1), stop_offset=Offset(20, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(12, 1), stop_offset=Offset(20, 1))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(start_offset=Offset(10, 1), stop_offset=Offset(20, 1))])</span>

<span class="sd">        Returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">trisects_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">contains_timespan_improperly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">overlaps_only_start_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">overlaps_only_stop_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">starts_when_timespan_starts</span><span class="p">(</span>
            <span class="bp">self</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">stops_before_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">stops_when_timespan_stops</span><span class="p">(</span>
            <span class="bp">self</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">starts_after_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timespans</span>

    <span class="k">def</span> <span class="nf">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical XOR of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 ^ timespan_2</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 ^ timespan_3</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_1 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_2 ^ timespan_3</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_2 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; new_timespan = timespan_3 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(new_timespan)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span>
            <span class="n">argument</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tangent_to_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">argument</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">start_offsets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span>
        <span class="n">stop_offsets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">]</span>
        <span class="n">start_offsets</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">stop_offsets</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">timespan_1</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">start_offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">timespan_2</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">stop_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">timespan_1</span><span class="o">.</span><span class="n">wellformed</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timespan_2</span><span class="o">.</span><span class="n">wellformed</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_2</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_as_postscript</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">,</span> <span class="n">postscript_scale</span>
    <span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">start</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">stop</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">Postscript</span><span class="p">()</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">lineto</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">postscript_y_offset</span> <span class="o">+</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">lineto</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">postscript_y_offset</span> <span class="o">-</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">postscript_y_offset</span> <span class="o">+</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">lineto</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="n">postscript_y_offset</span> <span class="o">-</span> <span class="mf">0.75</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ps</span>

    <span class="k">def</span> <span class="nf">_can_fuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span>
                <span class="n">argument</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">stops_when_timespan_starts</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_get_format_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FormatSpecification</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_offsets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;start_offset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;stop_offset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span>

    <span class="k">def</span> <span class="nf">_get_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span><span class="o">.</span><span class="n">offsets</span>
        <span class="c1"># TODO: remove this branch in favor of the _get_timespan above</span>
        <span class="c1"># elif hasattr(argument, &#39;timespan&#39;):</span>
        <span class="c1">#    start_offset, stop_offset = argument.timespan().offsets</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_implements_timespan_interface</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;start_offset&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span>
            <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;stop_offset&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># TODO: remove this branch in favor of the _get_timespan above</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_initialize_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">offset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">Infinity</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">offset</span>
        <span class="k">return</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_expression</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">evaluation_template</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">map_operand</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="n">_frame_to_callback</span><span class="p">(</span>
            <span class="n">frame</span><span class="p">,</span>
            <span class="n">evaluation_template</span><span class="o">=</span><span class="n">evaluation_template</span><span class="p">,</span>
            <span class="n">map_operand</span><span class="o">=</span><span class="n">map_operand</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="o">.</span><span class="n">append_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Offset</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arithmetic mean of timespan start- and stop-offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).axis</span>
<span class="sd">            Offset(5, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).duration</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wellformed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan start offset preceeds timespan stop offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).wellformed</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Offset</span><span class="p">,</span> <span class="n">Offset</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).offsets</span>
<span class="sd">            (Offset(0, 1), Offset(10, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Offset</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).start_offset</span>
<span class="sd">            Offset(0, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Offset</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets stop offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).stop_offset</span>
<span class="sd">            Offset(10, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="c1">### PUBLIC METHODS ###</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">contains_timespan_improperly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan contains ``timespan`` improperly.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.contains_timespan_improperly(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.contains_timespan_improperly(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.contains_timespan_improperly(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.contains_timespan_improperly(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 5)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.contains_timespan_improperly(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 10)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;=</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">curtails_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan curtails ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.curtails_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.curtails_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.curtails_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.curtails_timespan(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan().curtails_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(15, 25)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;=</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delays_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan delays ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.delays_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.delays_timespan(timespan_3)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(5, 15)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan().delays_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">divide_by_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;Timespan&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divides timespan by ``ratio``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; for x in timespan.divide_by_ratio((1, 2, 1)):</span>
<span class="sd">            ...     x</span>
<span class="sd">            Timespan(start_offset=Offset(1, 2), stop_offset=Offset(3, 4))</span>
<span class="sd">            Timespan(start_offset=Offset(3, 4), stop_offset=Offset(5, 4))</span>
<span class="sd">            Timespan(start_offset=Offset(5, 4), stop_offset=Offset(3, 2))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">Ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="n">unit_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ratio</span><span class="o">.</span><span class="n">numbers</span><span class="p">)</span>
        <span class="n">part_durations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">numerator</span> <span class="o">*</span> <span class="n">unit_duration</span> <span class="k">for</span> <span class="n">numerator</span> <span class="ow">in</span> <span class="n">ratio</span><span class="o">.</span><span class="n">numbers</span>
        <span class="p">]</span>
        <span class="n">start_offsets</span> <span class="o">=</span> <span class="n">mathtools</span><span class="o">.</span><span class="n">cumulative_sums</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">]</span> <span class="o">+</span> <span class="n">part_durations</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">offset_pairs</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">)</span><span class="o">.</span><span class="n">nwise</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="o">*</span><span class="n">offset_pair</span><span class="p">)</span> <span class="k">for</span> <span class="n">offset_pair</span> <span class="ow">in</span> <span class="n">offset_pairs</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_overlap_with_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Duration</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of overlap with ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 15)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(6, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(12, 22)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_1)</span>
<span class="sd">            Duration(15, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_2)</span>
<span class="sd">            Duration(5, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(3, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_2)</span>
<span class="sd">            Duration(5, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_3.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_3.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_4.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implements_timespan_interface</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">duration</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span> <span class="o">&amp;</span> <span class="n">timespan</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">happens_during_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan happens during ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.happens_during_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.happens_during_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.happens_during_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.happens_during_timespan(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan().happens_during_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;=</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_stop_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">intersects_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan intersects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(10, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.intersects_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.intersects_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.intersects_timespan(timespan_3)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan().intersects_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;=</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">is_congruent_to_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan is congruent to ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.is_congruent_to_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.is_congruent_to_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.is_congruent_to_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.is_congruent_to_timespan(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan().is_congruent_to_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">==</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">==</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_tangent_to_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan is tangent to ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.is_tangent_to_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.is_tangent_to_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.is_tangent_to_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.is_tangent_to_timespan(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_stop_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
            <span class="ow">or</span> <span class="n">expr_stop_offset</span> <span class="o">==</span> <span class="n">self_start_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">overlaps_all_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps all of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_all_of_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_all_of_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_all_of_timespan(timespan_3)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(5, 6)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.overlaps_all_of_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 6)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 10)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">overlaps_only_start_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps only start of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(-5, 5)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(4, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_start_of_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_start_of_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_start_of_timespan(timespan_3)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_start_of_timespan(timespan_4)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.overlaps_only_start_of_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(4, 6)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
            <span class="ow">and</span> <span class="n">self_stop_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">overlaps_only_stop_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps only stop of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(-5, 5)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(4, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_stop_of_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_stop_of_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_stop_of_timespan(timespan_3)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_only_stop_of_timespan(timespan_4)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.overlaps_only_stop_of_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(4, 6)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;=</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">overlaps_start_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps start of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(-5, 5)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(4, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_start_of_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_start_of_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_start_of_timespan(timespan_3)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_start_of_timespan(timespan_4)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.overlaps_start_of_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(4, 6)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>
            <span class="ow">and</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">overlaps_stop_of_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps start of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(-5, 5)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(4, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_stop_of_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_stop_of_timespan(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_stop_of_timespan(timespan_3)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.overlaps_stop_of_timespan(timespan_4)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.overlaps_stop_of_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(4, 6)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
            <span class="ow">and</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects timespan about ``axis``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reverse timespan about timespan axis:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 6).reflect()</span>
<span class="sd">            Timespan(start_offset=Offset(3, 1), stop_offset=Offset(6, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reverse timespan about arbitrary axis:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 6).reflect(axis=abjad.Offset(10))</span>
<span class="sd">            Timespan(start_offset=Offset(14, 1), stop_offset=Offset(17, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">start_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">-</span> <span class="n">axis</span>
        <span class="n">stop_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">-</span> <span class="n">axis</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">-</span> <span class="n">stop_distance</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">-</span> <span class="n">start_distance</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">new_stop_offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">round_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span> <span class="n">must_be_wellformed</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rounds timespan offsets to multiple of ``multiplier``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 5), (4, 5))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(1)</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(1, 1))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(2)</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(2, 1))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(</span>
<span class="sd">            ...     2,</span>
<span class="sd">            ...     anchor=abjad.Right,</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(-2, 1), stop_offset=Offset(0, 1))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(</span>
<span class="sd">            ...     2,</span>
<span class="sd">            ...     anchor=abjad.Right,</span>
<span class="sd">            ...     must_be_wellformed=False,</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(0, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Multiplier</span><span class="p">(</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">))</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">))</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">new_start_offset</span> <span class="o">==</span> <span class="n">new_stop_offset</span><span class="p">)</span> <span class="ow">and</span> <span class="n">must_be_wellformed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">:</span>
                <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">new_stop_offset</span> <span class="o">+</span> <span class="n">multiplier</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">new_start_offset</span> <span class="o">-</span> <span class="n">multiplier</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales timespan by ``multiplier``.</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(3, 6)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scale timespan relative to timespan start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.scale(abjad.Multiplier(2))</span>
<span class="sd">            Timespan(start_offset=Offset(3, 1), stop_offset=Offset(9, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scale timespan relative to timespan stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.scale(abjad.Multiplier(2), anchor=abjad.Right)</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(6, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">Multiplier</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="n">new_duration</span> <span class="o">=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="o">==</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">+</span> <span class="n">new_duration</span>
        <span class="k">elif</span> <span class="n">anchor</span> <span class="o">==</span> <span class="n">enums</span><span class="o">.</span><span class="n">Right</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">-</span> <span class="n">new_duration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;unknown anchor direction: </span><span class="si">{!r}</span><span class="s2">.&quot;</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">anchor</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">set_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets timespan duration to ``duration``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_duration((3, 5))</span>
<span class="sd">            Timespan(start_offset=Offset(1, 2), stop_offset=Offset(11, 10))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="k">return</span> <span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets timespan start offset to ``start_offset`` and</span>
<span class="sd">        stop offset to ``stop_offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_offsets(stop_offset=(7, 8))</span>
<span class="sd">            Timespan(start_offset=Offset(1, 2), stop_offset=Offset(7, 8))</span>

<span class="sd">        Subtracts negative ``start_offset`` from existing stop offset:</span>

<span class="sd">        &gt;&gt;&gt; timespan.set_offsets(start_offset=(-1, 2))</span>
<span class="sd">        Timespan(start_offset=Offset(1, 1), stop_offset=Offset(3, 2))</span>

<span class="sd">        Subtracts negative ``stop_offset`` from existing stop offset:</span>

<span class="sd">        &gt;&gt;&gt; timespan.set_offsets(stop_offset=(-1, 2))</span>
<span class="sd">        Timespan(start_offset=Offset(1, 2), stop_offset=Offset(1, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">start_offset</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">start_offset</span>
        <span class="k">elif</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">start_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">+</span> <span class="n">Offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
        <span class="k">if</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">stop_offset</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
        <span class="k">elif</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">+</span> <span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1"># TODO: extend to self.split_at_offsets()</span>
    <span class="k">def</span> <span class="nf">split_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split into two parts when ``offset`` happens during timespan:</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 5)</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespan.split_at_offset((2, 1))</span>

<span class="sd">            &gt;&gt;&gt; left</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(2, 1))</span>

<span class="sd">            &gt;&gt;&gt; right</span>
<span class="sd">            Timespan(start_offset=Offset(2, 1), stop_offset=Offset(5, 1))</span>

<span class="sd">            Otherwise return a copy of timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespan.split_at_offset((12, 1))[0]</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(5, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">offset</span>
            <span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">split_at_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split into one or more parts when ``offsets`` happens during</span>
<span class="sd">        timespan:</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; result = timespan.split_at_offsets((1, 3, 7))</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            Otherwise return a timespan list containing a copy of timespan:</span>

<span class="sd">            &gt;&gt;&gt; result = timespan.split_at_offsets((-100,))</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">offset</span>
            <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>
        <span class="p">]</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">offsets</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">starts_after_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan overlaps start of ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((-5, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_after_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts after ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_after_timespan_starts(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_after_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_after_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_after_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts after ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(10, 20)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(15, 25)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_after_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_3.starts_after_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_4.starts_after_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_after_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        ..  todo:: Is this wrong?</span>

<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;=</span> <span class="n">self_start_offset</span>

    <span class="k">def</span> <span class="nf">starts_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_offset((0, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">==</span> <span class="n">offset</span>

    <span class="k">def</span> <span class="nf">starts_at_or_after_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts at or after ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_or_after_offset((-5, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_or_after_offset((0, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_at_or_after_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>

    <span class="k">def</span> <span class="nf">starts_before_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts before ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_offset((5, 1))</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;</span> <span class="n">offset</span>

    <span class="k">def</span> <span class="nf">starts_before_or_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts before or at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_or_at_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_or_at_offset((0, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_or_at_offset((5, 1))</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">&lt;=</span> <span class="n">offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_before_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts before ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_timespan_starts(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_before_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_before_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_before_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_before_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts before ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_before_timespan_stops(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_before_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_before_timespan_stops(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_before_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_during_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts during ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_during_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_during_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_during_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_during_timespan(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_during_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;=</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_start_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_when_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts when ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 15)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_when_timespan_starts(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_when_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_when_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_when_timespan_starts(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_when_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr_start_offset</span> <span class="o">==</span> <span class="n">self_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">starts_when_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan starts when ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_when_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_when_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_when_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.starts_when_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.starts_when_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-5, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_start_offset</span> <span class="o">==</span> <span class="n">expr_stop_offset</span>

    <span class="k">def</span> <span class="nf">stops_after_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops after ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((-5, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.starts_after_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_after_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops when ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_after_timespan_starts(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_after_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_after_timespan_starts(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_after_timespan_starts(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_after_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_after_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops when ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_after_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_after_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_after_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_after_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_after_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr_stop_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>

    <span class="k">def</span> <span class="nf">stops_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">==</span> <span class="n">offset</span>

    <span class="k">def</span> <span class="nf">stops_at_or_after_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops at or after ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_or_after_offset((-5, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_or_after_offset((0, 1))</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_at_or_after_offset((5, 1))</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span>

    <span class="k">def</span> <span class="nf">stops_before_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops before ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&lt;</span> <span class="n">offset</span>

    <span class="k">def</span> <span class="nf">stops_before_or_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops before or at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_or_at_offset((-5, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_or_at_offset((0, 1))</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_or_at_offset((5, 1))</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">&lt;=</span> <span class="n">offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_before_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops before ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_before_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_before_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_before_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_stop_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_before_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops before ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_before_timespan_stops(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_before_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_before_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_before_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_stop_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_during_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops during ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_during_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_during_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_during_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_during_timespan(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_during_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            True</span>

<span class="sd">            TODO: is this one wrong:</span>

<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_stop_offset</span>
            <span class="ow">and</span> <span class="n">self_stop_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_when_timespan_starts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops when ``timespan`` starts.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_when_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_when_timespan_starts(timespan_2)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_when_timespan_starts(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_when_timespan_starts(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_when_timespan_starts(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_stop_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stops_when_timespan_stops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan stops when ``timespan`` stops.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.stops_when_timespan_stops(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.stops_when_timespan_stops(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_when_timespan_stops(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.stops_when_timespan_stops(timespan_2)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.stops_when_timespan_stops(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self_stop_offset</span> <span class="o">==</span> <span class="n">expr_stop_offset</span>

    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stretches timespan by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to timespan start offset:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Multiplier(2))</span>
<span class="sd">            Timespan(start_offset=Offset(3, 1), stop_offset=Offset(17, 1))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to timespan stop offset:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(</span>
<span class="sd">            ...     abjad.Multiplier(2),</span>
<span class="sd">            ...     abjad.Offset(10),</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(-4, 1), stop_offset=Offset(10, 1))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset prior to timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(</span>
<span class="sd">            ...     abjad.Multiplier(2),</span>
<span class="sd">            ...     abjad.Offset(0, 1),</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(6, 1), stop_offset=Offset(20, 1))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset after timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(</span>
<span class="sd">            ...     abjad.Multiplier(3),</span>
<span class="sd">            ...     abjad.Offset(12),</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(-15, 1), stop_offset=Offset(6, 1))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset that happens during timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(</span>
<span class="sd">            ...     abjad.Multiplier(2),</span>
<span class="sd">            ...     abjad.Offset(4),</span>
<span class="sd">            ...     )</span>
<span class="sd">            Timespan(start_offset=Offset(2, 1), stop_offset=Offset(16, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">Multiplier</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">anchor</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">))</span> <span class="o">+</span> <span class="n">anchor</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespan by ``translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan.translate(2)</span>
<span class="sd">            Timespan(start_offset=Offset(7, 1), stop_offset=Offset(12, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset_translation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset_translation</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespan start offset by ``start_offset_translation`` and</span>
<span class="sd">        stop offset by ``stop_offset_translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.translate_offsets(start_offset_translation=(-1, 8))</span>
<span class="sd">            Timespan(start_offset=Offset(3, 8), stop_offset=Offset(3, 2))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_offset_translation</span> <span class="o">=</span> <span class="n">start_offset_translation</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">stop_offset_translation</span> <span class="o">=</span> <span class="n">stop_offset_translation</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">start_offset_translation</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start_offset_translation</span><span class="p">)</span>
        <span class="n">stop_offset_translation</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">stop_offset_translation</span><span class="p">)</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">+</span> <span class="n">start_offset_translation</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">+</span> <span class="n">stop_offset_translation</span>
        <span class="k">return</span> <span class="n">new</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@Signature</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">trisects_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan trisects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 6)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.trisects_timespan(timespan_1)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_1.trisects_timespan(timespan_2)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.trisects_timespan(timespan_1)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; timespan_2.trisects_timespan(timespan_2)</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example expression</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; expression = expression.trisects_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; expression(-15, -5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-10, 0)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(-5, 5)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(0, 10)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(5, 15)</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; expression(10, 20)</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; expression(4, 6)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">self_start_offset</span><span class="p">,</span> <span class="n">self_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">expr_start_offset</span><span class="p">,</span> <span class="n">expr_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">expr_start_offset</span> <span class="o">&lt;</span> <span class="n">self_start_offset</span>
            <span class="ow">and</span> <span class="n">self_stop_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">AnnotatedTimespan</span><span class="p">(</span><span class="n">Timespan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Annotated timespan.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; annotated_timespan = abjad.AnnotatedTimespan(</span>
<span class="sd">        ...    annotation=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">        ...    start_offset=(1, 4),</span>
<span class="sd">        ...    stop_offset=(7, 8),</span>
<span class="sd">        ...    )</span>
<span class="sd">        &gt;&gt;&gt; abjad.f(annotated_timespan)</span>
<span class="sd">        abjad.AnnotatedTimespan(</span>
<span class="sd">            start_offset=abjad.Offset(1, 4),</span>
<span class="sd">            stop_offset=abjad.Offset(7, 8),</span>
<span class="sd">            annotation=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="sd">            )</span>

<span class="sd">    Annotated timespans maintain their annotations duration mutation:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; left, right = annotated_timespan.split_at_offset((1, 2))</span>
<span class="sd">        &gt;&gt;&gt; left.annotation.append(&#39;foo&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.f(right)</span>
<span class="sd">        abjad.AnnotatedTimespan(</span>
<span class="sd">            start_offset=abjad.Offset(1, 2),</span>
<span class="sd">            stop_offset=abjad.Offset(7, 8),</span>
<span class="sd">            annotation=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;foo&#39;],</span>
<span class="sd">            )</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Timespans&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_annotation&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start_offset</span><span class="o">=</span><span class="n">NegativeInfinity</span><span class="p">,</span>
        <span class="n">stop_offset</span><span class="o">=</span><span class="n">Infinity</span><span class="p">,</span>
        <span class="n">annotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Timespan</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation</span> <span class="o">=</span> <span class="n">annotation</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets annotated timespan annotation.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets annotation:</span>

<span class="sd">            &gt;&gt;&gt; annotated_timespan = abjad.AnnotatedTimespan(</span>
<span class="sd">            ...    annotation=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;foo&#39;],</span>
<span class="sd">            ...    start_offset=(1, 4),</span>
<span class="sd">            ...    stop_offset=(7, 8),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; annotated_timespan.annotation</span>
<span class="sd">            [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;foo&#39;]</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Sets annotation:</span>

<span class="sd">            &gt;&gt;&gt; annotated_timespan.annotation = &#39;baz&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_annotation</span>

    <span class="nd">@annotation</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation</span> <span class="o">=</span> <span class="n">argument</span>


<span class="k">class</span> <span class="nc">TimespanList</span><span class="p">(</span><span class="n">TypedList</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Timespan list.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Contiguous timespan list:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, 3),</span>
<span class="sd">        ...     abjad.Timespan(3, 6),</span>
<span class="sd">        ...     abjad.Timespan(6, 10),</span>
<span class="sd">        ...     ])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">        abjad.TimespanList(</span>
<span class="sd">            [</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Overlapping timespan list:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, 16),</span>
<span class="sd">        ...     abjad.Timespan(5, 12),</span>
<span class="sd">        ...     abjad.Timespan(-2, 8),</span>
<span class="sd">        ...     abjad.Timespan(15, 20),</span>
<span class="sd">        ...     abjad.Timespan(24, 30),</span>
<span class="sd">        ...     ])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">        abjad.TimespanList(</span>
<span class="sd">            [</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(16, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(24, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Empty timespan list:</span>

<span class="sd">        &gt;&gt;&gt; abjad.TimespanList()</span>
<span class="sd">        TimespanList([])</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Coerces input:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, (1, 2)),</span>
<span class="sd">        ...     ((1, 2), (3, 4)),</span>
<span class="sd">        ...     abjad.Timespan((3, 4), 1),</span>
<span class="sd">        ...     ])</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">        abjad.TimespanList(</span>
<span class="sd">            [</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                    stop_offset=abjad.Offset(1, 2),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(1, 2),</span>
<span class="sd">                    stop_offset=abjad.Offset(3, 4),</span>
<span class="sd">                    ),</span>
<span class="sd">                abjad.Timespan(</span>
<span class="sd">                    start_offset=abjad.Offset(3, 4),</span>
<span class="sd">                    stop_offset=abjad.Offset(1, 1),</span>
<span class="sd">                    ),</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>

<span class="sd">    Operations on timespan currently work in place.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Timespans&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Keeps material that intersects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Keeps material that intersects timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; _ = timespans &amp; timespan</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_timespans</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">current_timespan</span> <span class="o">&amp;</span> <span class="n">timespan</span>
            <span class="n">new_timespans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_timespans</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__illustrate__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sort_callable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sortkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Illustrates timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Illustrates timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan_operand = abjad.Timespan(6, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans - timespan_operand</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file = timespans.__illustrate__()</span>
<span class="sd">                &gt;&gt;&gt; markup = lilypond_file.items[-1]</span>
<span class="sd">                &gt;&gt;&gt; abjad.f(markup)</span>
<span class="sd">                \markup {</span>
<span class="sd">                    \column</span>
<span class="sd">                        {</span>
<span class="sd">                            \overlay</span>
<span class="sd">                                {</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(1.0 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        -2</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(17.666666666666668 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        0</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(59.33333333333334 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        5</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(67.66666666666667 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        6</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(101.00000000000001 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        10</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(117.66666666666667 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        12</span>
<span class="sd">                                                        1</span>
<span class="sd">                                    \translate</span>
<span class="sd">                                        #&#39;(151.0 . 1)</span>
<span class="sd">                                        \sans</span>
<span class="sd">                                            \fontsize</span>
<span class="sd">                                                #-3</span>
<span class="sd">                                                \center-align</span>
<span class="sd">                                                    \fraction</span>
<span class="sd">                                                        16</span>
<span class="sd">                                                        1</span>
<span class="sd">                                }</span>
<span class="sd">                            \pad-to-box</span>
<span class="sd">                                #&#39;(0 . 82.33333333333333)</span>
<span class="sd">                                #&#39;(0 . 8.5)</span>
<span class="sd">                                \postscript</span>
<span class="sd">                                    #&quot;</span>
<span class="sd">                                    0.2 setlinewidth</span>
<span class="sd">                                    1 6.5 moveto</span>
<span class="sd">                                    67.66666666666667 6.5 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    1 7.25 moveto</span>
<span class="sd">                                    1 5.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    67.66666666666667 7.25 moveto</span>
<span class="sd">                                    67.66666666666667 5.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    17.666666666666668 3.5 moveto</span>
<span class="sd">                                    67.66666666666667 3.5 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    17.666666666666668 4.25 moveto</span>
<span class="sd">                                    17.666666666666668 2.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    67.66666666666667 4.25 moveto</span>
<span class="sd">                                    67.66666666666667 2.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    101.00000000000001 3.5 moveto</span>
<span class="sd">                                    151 3.5 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    101.00000000000001 4.25 moveto</span>
<span class="sd">                                    101.00000000000001 2.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    151 4.25 moveto</span>
<span class="sd">                                    151 2.75 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    59.33333333333334 0.5 moveto</span>
<span class="sd">                                    67.66666666666667 0.5 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    59.33333333333334 1.25 moveto</span>
<span class="sd">                                    59.33333333333334 -0.25 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    67.66666666666667 1.25 moveto</span>
<span class="sd">                                    67.66666666666667 -0.25 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    101.00000000000001 0.5 moveto</span>
<span class="sd">                                    117.66666666666667 0.5 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    101.00000000000001 1.25 moveto</span>
<span class="sd">                                    101.00000000000001 -0.25 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    117.66666666666667 1.25 moveto</span>
<span class="sd">                                    117.66666666666667 -0.25 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    0.1 setlinewidth</span>
<span class="sd">                                    [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                                    1 8.5 moveto</span>
<span class="sd">                                    1 7 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    17.666666666666668 8.5 moveto</span>
<span class="sd">                                    17.666666666666668 4 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    59.33333333333334 8.5 moveto</span>
<span class="sd">                                    59.33333333333334 1 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    67.66666666666667 8.5 moveto</span>
<span class="sd">                                    67.66666666666667 1 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    101.00000000000001 8.5 moveto</span>
<span class="sd">                                    101.00000000000001 1 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    117.66666666666667 8.5 moveto</span>
<span class="sd">                                    117.66666666666667 1 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    151 8.5 moveto</span>
<span class="sd">                                    151 4 lineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    0 0 moveto</span>
<span class="sd">                                    0.99 setgray</span>
<span class="sd">                                    0 0.01 rlineto</span>
<span class="sd">                                    stroke</span>
<span class="sd">                                    &quot;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set ``key`` and ``sort_callable`` together like this to customize</span>
<span class="sd">            timespan sorting:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.AnnotatedTimespan(0, (1, 4), annotation=&quot;voice 1&quot;),</span>
<span class="sd">            ...     abjad.AnnotatedTimespan(0, (1, 4), annotation=&quot;voice 2&quot;),</span>
<span class="sd">            ...     abjad.AnnotatedTimespan(0, (1, 4), annotation=&quot;voice 10&quot;),</span>
<span class="sd">            ...     ])</span>

<span class="sd">            &gt;&gt;&gt; def to_digit(string):</span>
<span class="sd">            ...     return int(string) if string.isdigit() else string</span>

<span class="sd">            &gt;&gt;&gt; def human_sorted_keys(pair):</span>
<span class="sd">            ...     key, timespan = pair</span>
<span class="sd">            ...     values = [to_digit(_) for _ in key.split()]</span>
<span class="sd">            ...     hashable_key = tuple(values)</span>
<span class="sd">            ...     return hashable_key</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(</span>
<span class="sd">            ...     timespans,</span>
<span class="sd">            ...     key=&quot;annotation&quot;,</span>
<span class="sd">            ...     sort_callable=human_sorted_keys,</span>
<span class="sd">            ...     scale=0.5,</span>
<span class="sd">            ...     ) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file = timespans.__illustrate__(</span>
<span class="sd">                ...     key=&quot;annotation&quot;,</span>
<span class="sd">                ...     sort_callable=human_sorted_keys,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; markup = lilypond_file.items[-1]</span>
<span class="sd">                &gt;&gt;&gt; abjad.f(markup)</span>
<span class="sd">                \markup {</span>
<span class="sd">                    \left-column</span>
<span class="sd">                        {</span>
<span class="sd">                            \fontsize</span>
<span class="sd">                                #-1</span>
<span class="sd">                                \sans</span>
<span class="sd">                                    \line</span>
<span class="sd">                                        {</span>
<span class="sd">                                            &quot;voice 1:&quot;</span>
<span class="sd">                                        }</span>
<span class="sd">                            \vspace</span>
<span class="sd">                                #0.5</span>
<span class="sd">                            \column</span>
<span class="sd">                                {</span>
<span class="sd">                                    \overlay</span>
<span class="sd">                                        {</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(1.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                0</span>
<span class="sd">                                                                1</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(151.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                1</span>
<span class="sd">                                                                4</span>
<span class="sd">                                        }</span>
<span class="sd">                                    \pad-to-box</span>
<span class="sd">                                        #&#39;(0 . 149.0)</span>
<span class="sd">                                        #&#39;(0 . 2.5)</span>
<span class="sd">                                        \postscript</span>
<span class="sd">                                            #&quot;</span>
<span class="sd">                                            0.2 setlinewidth</span>
<span class="sd">                                            1 0.5 moveto</span>
<span class="sd">                                            151 0.5 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            1 1.25 moveto</span>
<span class="sd">                                            1 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 1.25 moveto</span>
<span class="sd">                                            151 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0.1 setlinewidth</span>
<span class="sd">                                            [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                                            1 2.5 moveto</span>
<span class="sd">                                            1 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 2.5 moveto</span>
<span class="sd">                                            151 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0 0 moveto</span>
<span class="sd">                                            0.99 setgray</span>
<span class="sd">                                            0 0.01 rlineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            &quot;</span>
<span class="sd">                                }</span>
<span class="sd">                            \vspace</span>
<span class="sd">                                #0.5</span>
<span class="sd">                            \fontsize</span>
<span class="sd">                                #-1</span>
<span class="sd">                                \sans</span>
<span class="sd">                                    \line</span>
<span class="sd">                                        {</span>
<span class="sd">                                            &quot;voice 2:&quot;</span>
<span class="sd">                                        }</span>
<span class="sd">                            \vspace</span>
<span class="sd">                                #0.5</span>
<span class="sd">                            \column</span>
<span class="sd">                                {</span>
<span class="sd">                                    \overlay</span>
<span class="sd">                                        {</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(1.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                0</span>
<span class="sd">                                                                1</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(151.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                1</span>
<span class="sd">                                                                4</span>
<span class="sd">                                        }</span>
<span class="sd">                                    \pad-to-box</span>
<span class="sd">                                        #&#39;(0 . 149.0)</span>
<span class="sd">                                        #&#39;(0 . 2.5)</span>
<span class="sd">                                        \postscript</span>
<span class="sd">                                            #&quot;</span>
<span class="sd">                                            0.2 setlinewidth</span>
<span class="sd">                                            1 0.5 moveto</span>
<span class="sd">                                            151 0.5 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            1 1.25 moveto</span>
<span class="sd">                                            1 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 1.25 moveto</span>
<span class="sd">                                            151 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0.1 setlinewidth</span>
<span class="sd">                                            [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                                            1 2.5 moveto</span>
<span class="sd">                                            1 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 2.5 moveto</span>
<span class="sd">                                            151 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0 0 moveto</span>
<span class="sd">                                            0.99 setgray</span>
<span class="sd">                                            0 0.01 rlineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            &quot;</span>
<span class="sd">                                }</span>
<span class="sd">                            \vspace</span>
<span class="sd">                                #0.5</span>
<span class="sd">                            \fontsize</span>
<span class="sd">                                #-1</span>
<span class="sd">                                \sans</span>
<span class="sd">                                    \line</span>
<span class="sd">                                        {</span>
<span class="sd">                                            &quot;voice 10:&quot;</span>
<span class="sd">                                        }</span>
<span class="sd">                            \vspace</span>
<span class="sd">                                #0.5</span>
<span class="sd">                            \column</span>
<span class="sd">                                {</span>
<span class="sd">                                    \overlay</span>
<span class="sd">                                        {</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(1.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                0</span>
<span class="sd">                                                                1</span>
<span class="sd">                                            \translate</span>
<span class="sd">                                                #&#39;(151.0 . 1)</span>
<span class="sd">                                                \sans</span>
<span class="sd">                                                    \fontsize</span>
<span class="sd">                                                        #-3</span>
<span class="sd">                                                        \center-align</span>
<span class="sd">                                                            \fraction</span>
<span class="sd">                                                                1</span>
<span class="sd">                                                                4</span>
<span class="sd">                                        }</span>
<span class="sd">                                    \pad-to-box</span>
<span class="sd">                                        #&#39;(0 . 149.0)</span>
<span class="sd">                                        #&#39;(0 . 2.5)</span>
<span class="sd">                                        \postscript</span>
<span class="sd">                                            #&quot;</span>
<span class="sd">                                            0.2 setlinewidth</span>
<span class="sd">                                            1 0.5 moveto</span>
<span class="sd">                                            151 0.5 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            1 1.25 moveto</span>
<span class="sd">                                            1 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 1.25 moveto</span>
<span class="sd">                                            151 -0.25 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0.1 setlinewidth</span>
<span class="sd">                                            [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                                            1 2.5 moveto</span>
<span class="sd">                                            1 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            151 2.5 moveto</span>
<span class="sd">                                            151 1 lineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            0 0 moveto</span>
<span class="sd">                                            0.99 setgray</span>
<span class="sd">                                            0 0.01 rlineto</span>
<span class="sd">                                            stroke</span>
<span class="sd">                                            &quot;</span>
<span class="sd">                                }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">        Returns LilyPond file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">abjad</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="o">.</span><span class="n">null</span><span class="p">()</span><span class="o">.</span><span class="n">__illustrate__</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">range_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Timespan</span><span class="p">):</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">range_</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">elif</span> <span class="n">range_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">scale</span>
        <span class="n">minimum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">minimum</span><span class="p">))</span>
        <span class="n">maximum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">maximum</span><span class="p">))</span>
        <span class="n">postscript_scale</span> <span class="o">=</span> <span class="mf">150.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">maximum</span> <span class="o">-</span> <span class="n">minimum</span><span class="p">)</span>
        <span class="n">postscript_scale</span> <span class="o">*=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">postscript_x_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">minimum</span> <span class="o">*</span> <span class="n">postscript_scale</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_timespan_list_markup</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_scale</span><span class="p">,</span> <span class="n">sortkey</span><span class="o">=</span><span class="n">sortkey</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">timespan_lists</span><span class="p">:</span>
                    <span class="n">timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
                <span class="n">timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">markups</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">timespan_lists</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_callable</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">generator</span><span class="p">):</span>
                <span class="n">value</span><span class="p">,</span> <span class="n">timespans</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">timespans</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">vspace_markup</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="o">.</span><span class="n">vspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">markups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vspace_markup</span><span class="p">)</span>
                <span class="n">value_markup</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">:&quot;</span><span class="p">)</span>
                <span class="n">value_markup</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="o">.</span><span class="n">line</span><span class="p">([</span><span class="n">value_markup</span><span class="p">])</span>
                <span class="n">value_markup</span> <span class="o">=</span> <span class="n">value_markup</span><span class="o">.</span><span class="n">sans</span><span class="p">()</span><span class="o">.</span><span class="n">fontsize</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">markups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_markup</span><span class="p">)</span>
                <span class="n">vspace_markup</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="o">.</span><span class="n">vspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">markups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vspace_markup</span><span class="p">)</span>
                <span class="n">timespan_markup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_timespan_list_markup</span><span class="p">(</span>
                    <span class="n">timespans</span><span class="p">,</span>
                    <span class="n">postscript_x_offset</span><span class="p">,</span>
                    <span class="n">postscript_scale</span><span class="p">,</span>
                    <span class="n">sortkey</span><span class="o">=</span><span class="n">sortkey</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">markups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_markup</span><span class="p">)</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Markup</span><span class="o">.</span><span class="n">left_column</span><span class="p">(</span><span class="n">markups</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">markup</span><span class="o">.</span><span class="n">__illustrate__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inverts timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Inverts timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(~timespans, range_=(-2, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(~timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Inverts contiguous timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; ~timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">-</span> <span class="n">timespan</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes material that intersects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Deletes material that intersects timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; _ = timespans - timespan</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_timespans</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">current_timespan</span> <span class="o">-</span> <span class="n">timespan</span>
            <span class="n">new_timespans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_timespans</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">### PRIVATE PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_item_coercer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_coerce</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">timespans</span><span class="o">.</span><span class="n">Timespan</span><span class="o">.</span><span class="n">_implements_timespan_interface</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">argument</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">timespans</span><span class="o">.</span><span class="n">Timespan</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">argument</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">timespans</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="o">*</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">timespans</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">abjad</span> <span class="k">import</span> <span class="n">timespans</span>

        <span class="k">return</span> <span class="n">_coerce</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_make_timespan_list_markup</span><span class="p">(</span>
        <span class="n">timespans</span><span class="p">,</span>
        <span class="n">postscript_x_offset</span><span class="p">,</span>
        <span class="n">postscript_scale</span><span class="p">,</span>
        <span class="n">draw_offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">sortkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">exploded_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sortkey</span><span class="p">:</span>
            <span class="n">exploded_timespan_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sorted_timespan_lists</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="n">sortkey</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sorted_timespan_lists</span><span class="p">:</span>
                    <span class="n">sorted_timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
                <span class="n">sorted_timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">timespans</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sorted_timespan_lists</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">exploded_timespan_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">Postscript</span><span class="p">()</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">setlinewidth</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">offset_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">height</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">exploded_timespan_lists</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">timespans</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exploded_timespan_lists</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">postscript_y_offset</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">level</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">:</span>
                <span class="n">offset_mapping</span><span class="p">[</span><span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>
                <span class="n">offset_mapping</span><span class="p">[</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>
                <span class="n">ps</span> <span class="o">+=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">_as_postscript</span><span class="p">(</span>
                    <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">,</span> <span class="n">postscript_scale</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">draw_offsets</span><span class="p">:</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">Markup</span><span class="o">.</span><span class="n">postscript</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">markup</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">setlinewidth</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">setdash</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">offset_mapping</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">offset_mapping</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span>
            <span class="n">x_offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
            <span class="n">x_offset</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">lineto</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">level</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">setgray</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">rlineto</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="n">x_extent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">x_extent</span> <span class="o">*=</span> <span class="n">postscript_scale</span>
        <span class="n">x_extent</span> <span class="o">+=</span> <span class="n">postscript_x_offset</span>
        <span class="n">x_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_extent</span><span class="p">)</span>
        <span class="n">y_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">lines_markup</span> <span class="o">=</span> <span class="n">Markup</span><span class="o">.</span><span class="n">postscript</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
        <span class="n">lines_markup</span> <span class="o">=</span> <span class="n">lines_markup</span><span class="o">.</span><span class="n">pad_to_box</span><span class="p">(</span><span class="n">x_extent</span><span class="p">,</span> <span class="n">y_extent</span><span class="p">)</span>
        <span class="n">fraction_markups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">offset_mapping</span><span class="p">):</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">Multiplier</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span> <span class="o">=</span> <span class="n">offset</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="n">offset</span><span class="o">.</span><span class="n">denominator</span>
            <span class="n">fraction</span> <span class="o">=</span> <span class="n">Markup</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span>
            <span class="n">fraction</span> <span class="o">=</span> <span class="n">fraction</span><span class="o">.</span><span class="n">center_align</span><span class="p">()</span><span class="o">.</span><span class="n">fontsize</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sans</span><span class="p">()</span>
            <span class="n">x_translation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
            <span class="n">x_translation</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
            <span class="n">fraction</span> <span class="o">=</span> <span class="n">fraction</span><span class="o">.</span><span class="n">translate</span><span class="p">((</span><span class="n">x_translation</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">fraction_markups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
        <span class="n">fraction_markup</span> <span class="o">=</span> <span class="n">Markup</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">fraction_markups</span><span class="p">)</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="n">Markup</span><span class="o">.</span><span class="n">column</span><span class="p">([</span><span class="n">fraction_markup</span><span class="p">,</span> <span class="n">lines_markup</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">markup</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">all_are_contiguous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are contiguous.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are contiguous:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_contiguous</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans not contiguous:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_contiguous</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_contiguous</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">!=</span> <span class="n">last_stop_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">all_are_nonoverlapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are nonoverlapping.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are nonoverlapping:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_nonoverlapping</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans are overlapping:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_nonoverlapping</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_nonoverlapping</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">last_stop_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">last_stop_offset</span> <span class="o">&lt;</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">all_are_wellformed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are wellformed.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are wellformed:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are wellformed:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        Is false when timespans are not all wellformed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">wellformed</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Offset</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets axis defined equal to arithmetic mean of start- and stop-offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.axis</span>
<span class="sd">            Offset(5, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.axis</span>
<span class="sd">            Offset(14, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets none when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().axis is None</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">Offset</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="n">Offset</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets duration:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.duration</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets duration:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.duration</span>
<span class="sd">            Duration(32, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets zero when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().duration</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Infinity</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NegativeInfinity</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespans are in time order.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespans are sorted:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.is_sorted</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans are not sorted:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.is_sorted</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">nwise</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">left_timespan</span><span class="p">,</span> <span class="n">right_timespan</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Offset</span><span class="p">,</span> <span class="n">mathtools</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets start offset.</span>

<span class="sd">        Defined equal to earliest start offset of any timespan in list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.start_offset</span>
<span class="sd">            Offset(0, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.start_offset</span>
<span class="sd">            Offset(-2, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets negative infinity when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().start_offset</span>
<span class="sd">            NegativeInfinity</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">start_offset</span>
                    <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">NegativeInfinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Offset</span><span class="p">,</span> <span class="n">mathtools</span><span class="o">.</span><span class="n">Infinity</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets stop offset.</span>

<span class="sd">        Defined equal to latest stop offset of any timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.stop_offset</span>
<span class="sd">            Offset(10, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.stop_offset</span>
<span class="sd">            Offset(30, 1)</span>

<span class="sd">        ..  container:: example</span>


<span class="sd">            Gets infinity when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().stop_offset</span>
<span class="sd">            Infinity</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">stop_offset</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Infinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespan of timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(timespans.timespan, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.timespan</span>
<span class="sd">            Timespan(start_offset=Offset(0, 1), stop_offset=Offset(10, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(timespans.timespan, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.timespan</span>
<span class="sd">            Timespan(start_offset=Offset(-2, 1), stop_offset=Offset(30, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets infinite timespan when list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().timespan</span>
<span class="sd">            Timespan(start_offset=NegativeInfinity, stop_offset=Infinity)</span>

<span class="sd">        Returns timespan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">abjad</span> <span class="k">import</span> <span class="n">timespans</span>

        <span class="k">return</span> <span class="n">timespans</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>

    <span class="c1">### PUBLIC METHODS ###</span>

    <span class="k">def</span> <span class="nf">clip_timespan_durations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clips timespan durations.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; result = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     minimum=5,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(result, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; result = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     maximum=5,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(result, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; result = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     minimum=3,</span>
<span class="sd">            ...     maximum=7,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(result, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; result = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     minimum=3,</span>
<span class="sd">            ...     maximum=7,</span>
<span class="sd">            ...     anchor=abjad.Right,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(result, range_=(-2, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">anchor</span> <span class="ow">in</span> <span class="p">(</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Right</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">minimum</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">maximum</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">maximum</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">minimum</span> <span class="o">&lt;=</span> <span class="n">maximum</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;</span> <span class="n">minimum</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">:</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="n">minimum</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">minimum</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                        <span class="n">timespan</span><span class="p">,</span>
                        <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                        <span class="n">stop_offset</span><span class="o">=</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="o">&lt;</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">:</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="n">maximum</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">maximum</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span>
                        <span class="n">timespan</span><span class="p">,</span>
                        <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                        <span class="n">stop_offset</span><span class="o">=</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timespans</span>

    <span class="k">def</span> <span class="nf">compute_logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical AND of timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Same as setwise intersection.</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">timespan</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">return</span> <span class="bp">self</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timespans</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="n">timespan</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">compute_logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical OR of timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical OR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList()</span>
<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_or()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical OR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical OR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical OR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical OR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     abjad.Timespan(10, 20),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespans</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_can_fuse</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
                    <span class="n">timespans_</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">timespan</span>
                    <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">timespans_</span><span class="p">[:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">compute_logical_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical XOR of timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList()</span>
<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">                abjad.TimespanList(</span>
<span class="sd">                    [</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        ]</span>
<span class="sd">                    )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">                abjad.TimespanList(</span>
<span class="sd">                    [</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(0, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(2, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        ]</span>
<span class="sd">                    )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     abjad.Timespan(10, 20),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">                abjad.TimespanList(</span>
<span class="sd">                    [</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        abjad.Timespan(</span>
<span class="sd">                            start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                            stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                            ),</span>
<span class="sd">                        ]</span>
<span class="sd">                    )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(4, 8),</span>
<span class="sd">            ...     abjad.Timespan(2, 6),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical XOR:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.compute_logical_xor()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_fragments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">timespan_1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">timespan_1_fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">timespan_1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">timespan_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">revised_timespan_1_fragments</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">timespan_1_fragment</span> <span class="ow">in</span> <span class="n">timespan_1_fragments</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">timespan_2</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span><span class="n">timespan_1_fragment</span><span class="p">):</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">timespan_1_fragment</span> <span class="o">-</span> <span class="n">timespan_2</span>
                        <span class="n">revised_timespan_1_fragments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">revised_timespan_1_fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">timespan_1_fragment</span>
                        <span class="p">)</span>
                <span class="n">timespan_1_fragments</span> <span class="o">=</span> <span class="n">revised_timespan_1_fragments</span>
            <span class="n">all_fragments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespan_1_fragments</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">all_fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">compute_overlap_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Multiplier</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes overlap factor of timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Example timespan list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 15),</span>
<span class="sd">            ...     abjad.Timespan(20, 25),</span>
<span class="sd">            ...     abjad.Timespan(20, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor across the entire list:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor()</span>
<span class="sd">            Multiplier(7, 6)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor within a specific timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(-15, 0))</span>
<span class="sd">            Multiplier(0, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(-10, 5),</span>
<span class="sd">            ...     )</span>
<span class="sd">            Multiplier(1, 3)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(-5, 10))</span>
<span class="sd">            Multiplier(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(0, 15))</span>
<span class="sd">            Multiplier(4, 3)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(5, 20))</span>
<span class="sd">            Multiplier(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(10, 25))</span>
<span class="sd">            Multiplier(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(15, 30))</span>
<span class="sd">            Multiplier(1, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timespan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timespan</span>
        <span class="n">expression</span> <span class="o">=</span> <span class="n">_timespan_constructor</span><span class="p">()</span><span class="o">.</span><span class="n">intersects_timespan</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
        <span class="n">total_overlap</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span>
            <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">get_overlap_with_timespan</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">overlap_factor</span> <span class="o">=</span> <span class="n">total_overlap</span> <span class="o">/</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span>
        <span class="k">return</span> <span class="n">overlap_factor</span>

    <span class="k">def</span> <span class="nf">compute_overlap_factor_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes overlap factor for each consecutive offset pair in timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor mapping:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 15),</span>
<span class="sd">            ...     abjad.Timespan(20, 25),</span>
<span class="sd">            ...     abjad.Timespan(20, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; mapping = timespans.compute_overlap_factor_mapping()</span>
<span class="sd">            &gt;&gt;&gt; for timespan, overlap_factor in mapping.items():</span>
<span class="sd">            ...     timespan.start_offset, timespan.stop_offset, overlap_factor</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset(0, 1), Offset(5, 1), Multiplier(1, 1))</span>
<span class="sd">            (Offset(5, 1), Offset(10, 1), Multiplier(2, 1))</span>
<span class="sd">            (Offset(10, 1), Offset(15, 1), Multiplier(1, 1))</span>
<span class="sd">            (Offset(15, 1), Offset(20, 1), Multiplier(0, 1))</span>
<span class="sd">            (Offset(20, 1), Offset(25, 1), Multiplier(2, 1))</span>
<span class="sd">            (Offset(25, 1), Offset(30, 1), Multiplier(1, 1))</span>

<span class="sd">        Returns mapping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapping</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_offsets</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="o">.</span><span class="n">nwise</span><span class="p">():</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
            <span class="n">overlap_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_overlap_factor</span><span class="p">(</span><span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">mapping</span><span class="p">[</span><span class="n">timespan</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlap_factor</span>
        <span class="k">return</span> <span class="n">mapping</span>

    <span class="k">def</span> <span class="nf">count_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset(0, 1), 1)</span>
<span class="sd">            (Offset(3, 1), 2)</span>
<span class="sd">            (Offset(6, 1), 2)</span>
<span class="sd">            (Offset(10, 1), 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset(-2, 1), 1)</span>
<span class="sd">            (Offset(0, 1), 1)</span>
<span class="sd">            (Offset(5, 1), 1)</span>
<span class="sd">            (Offset(8, 1), 1)</span>
<span class="sd">            (Offset(12, 1), 1)</span>
<span class="sd">            (Offset(15, 1), 1)</span>
<span class="sd">            (Offset(16, 1), 1)</span>
<span class="sd">            (Offset(20, 1), 1)</span>
<span class="sd">            (Offset(24, 1), 1)</span>
<span class="sd">            (Offset(30, 1), 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(0, 6),</span>
<span class="sd">            ...     abjad.Timespan(0, 9),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 9), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset(0, 1), 3)</span>
<span class="sd">            (Offset(3, 1), 1)</span>
<span class="sd">            (Offset(6, 1), 1)</span>
<span class="sd">            (Offset(9, 1), 1)</span>

<span class="sd">        Returns counter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">abjad.meter</span> <span class="k">import</span> <span class="n">OffsetCounter</span>

        <span class="k">return</span> <span class="n">OffsetCounter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">inventory_count</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Explodes timespans into timespan lists, avoiding overlap, and</span>
<span class="sd">        distributing density as evenly as possible.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Example timespan list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(5, 13),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     abjad.Timespan(8, 9),</span>
<span class="sd">            ...     abjad.Timespan(15, 23),</span>
<span class="sd">            ...     abjad.Timespan(16, 21),</span>
<span class="sd">            ...     abjad.Timespan(17, 19),</span>
<span class="sd">            ...     abjad.Timespan(19, 20),</span>
<span class="sd">            ...     abjad.Timespan(25, 30),</span>
<span class="sd">            ...     abjad.Timespan(26, 29),</span>
<span class="sd">            ...     abjad.Timespan(32, 34),</span>
<span class="sd">            ...     abjad.Timespan(34, 37),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Explodes timespans into the optimal number of non-overlapping</span>
<span class="sd">            timespan_lists:</span>

<span class="sd">            &gt;&gt;&gt; for exploded_timespan_list in timespans.explode():</span>
<span class="sd">            ...     abjad.f(exploded_timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(13, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(17, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(37, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(21, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(25, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(23, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(26, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(29, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(32, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Explodes timespans into a less-than-optimal number of overlapping</span>
<span class="sd">            timespan_lists:</span>

<span class="sd">            &gt;&gt;&gt; for exploded_timespan_list in timespans.explode(</span>
<span class="sd">            ...     inventory_count=2):</span>
<span class="sd">            ...     abjad.f(exploded_timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(13, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(23, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(25, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(37, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(21, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(17, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(26, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(29, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(32, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Explodes timespans into a greater-than-optimal number of</span>
<span class="sd">            non-overlapping timespan lists:</span>

<span class="sd">            &gt;&gt;&gt; for exploded_timespan_list in timespans.explode(</span>
<span class="sd">            ...     inventory_count=6):</span>
<span class="sd">            ...     abjad.f(exploded_timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(21, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(37, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(23, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(17, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(19, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(26, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(29, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(32, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(34, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(13, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(25, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="nb">int</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">inventory_count</span>
        <span class="n">bounding_timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timespan</span>
        <span class="n">global_overlap_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">empty_timespans_pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">inventory_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">):</span>
                <span class="n">global_overlap_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">result_timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([])</span>
                <span class="n">empty_timespans_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">result_timespans</span><span class="p">))</span>
                <span class="n">result_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result_timespans</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">current_overlap_factor</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">current_timespan</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="n">bounding_timespan</span><span class="o">.</span><span class="n">duration</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">empty_timespans_pairs</span><span class="p">:</span>
                <span class="n">i</span><span class="p">,</span> <span class="n">empty_timespans</span> <span class="o">=</span> <span class="n">empty_timespans_pairs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">empty_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
                <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_overlap_factor</span>
                <span class="k">continue</span>
            <span class="n">nonoverlapping_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">overlapping_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result_timespans</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_timespan_lists</span><span class="p">):</span>
                <span class="n">local_overlap_factor</span> <span class="o">=</span> <span class="n">result_timespans</span><span class="o">.</span><span class="n">compute_overlap_factor</span><span class="p">(</span>
                    <span class="n">current_timespan</span>
                <span class="p">)</span>
                <span class="n">global_overlap_factor</span> <span class="o">=</span> <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">local_overlap_factor</span><span class="p">:</span>
                    <span class="n">nonoverlapping_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">global_overlap_factor</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">overlapping_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">local_overlap_factor</span><span class="p">,</span> <span class="n">global_overlap_factor</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="n">nonoverlapping_timespan_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">overlapping_timespan_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nonoverlapping_timespan_lists</span> <span class="ow">and</span> <span class="n">inventory_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result_timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">current_timespan</span><span class="p">])</span>
                <span class="n">global_overlap_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_overlap_factor</span><span class="p">)</span>
                <span class="n">result_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result_timespans</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">nonoverlapping_timespan_lists</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">nonoverlapping_timespan_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">overlapping_timespan_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">result_timespans</span> <span class="o">=</span> <span class="n">result_timespan_lists</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">result_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">current_overlap_factor</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result_timespan_lists</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_timespan_that_satisfies_time_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespan that satisifies ``time_relation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 5)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; time_relation = time_relation.starts_during_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; timespan = timespans.get_timespan_that_satisfies_time_relation(</span>
<span class="sd">            ...     time_relation)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespan, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan</span>
<span class="sd">            Timespan(start_offset=Offset(3, 1), stop_offset=Offset(6, 1))</span>

<span class="sd">        Returns timespan when timespan list contains exactly one</span>
<span class="sd">        timespan that satisfies ``time_relation``.</span>

<span class="sd">        Raises exception when timespan list contains no timespan</span>
<span class="sd">        that satisfies ``time_relation``.</span>

<span class="sd">        Raises exception when timespan list contains more than one</span>
<span class="sd">        timespan that satisfies ``time_relation``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span>
            <span class="n">time_relation</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;extra timespan.&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;missing timespan.&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_timespans_that_satisfy_time_relation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespans that satisfy ``time_relation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 8)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; time_relation = time_relation.starts_during_timespan(timespan)</span>
<span class="sd">            &gt;&gt;&gt; result = timespans.get_timespans_that_satisfy_time_relation(</span>
<span class="sd">            ...     time_relation)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(result, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(result)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_relation</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">time_relation</span><span class="p">(</span><span class="o">*</span><span class="n">timespan</span><span class="o">.</span><span class="n">offsets</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;unknown time relation: </span><span class="si">{!r}</span><span class="s2">.&quot;</span>
                <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time_relation</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_timespan_that_satisfies_time_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan list has timespan that satisfies ``time_relation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when list has matching timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 8)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; time_relation = time_relation.starts_during_timespan(timespan)</span>
<span class="sd">            &gt;&gt;&gt; timespans.has_timespan_that_satisfies_time_relation(</span>
<span class="sd">            ...     time_relation)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when list does not have matching timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(10, 20)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = abjad.timespan()</span>
<span class="sd">            &gt;&gt;&gt; time_relation = time_relation.starts_during_timespan(timespan)</span>

<span class="sd">            &gt;&gt;&gt; timespans.has_timespan_that_satisfies_time_relation(</span>
<span class="sd">            ...     time_relation)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span><span class="n">time_relation</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">include_tangent_timespans</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partitions timespans into timespan lists.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition():</span>
<span class="sd">            ...     abjad.f(timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition():</span>
<span class="sd">            ...     abjad.f(timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(8, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(16, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Treats tangent timespans as part of the same group when</span>
<span class="sd">            ``include_tangent_timespans`` is true:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition(</span>
<span class="sd">            ...     include_tangent_timespans=True,</span>
<span class="sd">            ...     ):</span>
<span class="sd">            ...     abjad.f(timespan_list)</span>
<span class="sd">            ...</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Returns zero or more timespan_lists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>
        <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">current_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">latest_stop_offset</span> <span class="o">=</span> <span class="n">current_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">latest_stop_offset</span><span class="p">:</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">include_tangent_timespans</span>
                <span class="ow">and</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">latest_stop_offset</span>
            <span class="p">):</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_list</span><span class="p">)</span>
                <span class="n">current_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">current_timespan</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">latest_stop_offset</span> <span class="o">&lt;</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">latest_stop_offset</span> <span class="o">=</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">if</span> <span class="n">current_list</span><span class="p">:</span>
            <span class="n">timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">timespan_lists</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reflects timespans about timespan list axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.reflect()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reflects timespans about arbitrary axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.reflect(axis=abjad.Offset(15))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(24, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(27, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(27, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="n">timespans</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">remove_degenerate_timespans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes degenerate timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Removes degenerate timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(5, 5),</span>
<span class="sd">            ...     abjad.Timespan(5, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 25),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.remove_degenerate_timespans()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(25, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">wellformed</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">repeat_to_stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Repeats timespans to ``stop_offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Repeats timespans to stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 15), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.repeat_to_stop_offset(15)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 15), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(13, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(13, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(15, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sorted</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="n">stop_offset</span>
        <span class="n">current_timespan_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">current_timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">current_timespan_index</span><span class="p">]</span>
                <span class="n">translation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span>
                <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">translation</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_timespan</span><span class="p">)</span>
                <span class="n">current_timespan_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotates by ``count`` contiguous timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rotates by one timespan to the left:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 4),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.rotate(-1)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(1, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(7, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rotates by one timespan to the right:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 4),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.rotate(1)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_are_contiguous</span>
        <span class="n">elements_to_move</span> <span class="o">=</span> <span class="n">count</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elements_to_move</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">left_timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:</span><span class="o">-</span><span class="n">elements_to_move</span><span class="p">]</span>
        <span class="n">right_timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="n">elements_to_move</span><span class="p">:]</span>
        <span class="n">split_offset</span> <span class="o">=</span> <span class="n">right_timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">translation_to_left</span> <span class="o">=</span> <span class="n">split_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">translation_to_left</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">translation_to_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">split_offset</span>
        <span class="n">translated_right_timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">right_timespan</span> <span class="ow">in</span> <span class="n">right_timespans</span><span class="p">:</span>
            <span class="n">translated_right_timespan</span> <span class="o">=</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">translation_to_left</span><span class="p">,</span> <span class="n">translation_to_left</span>
            <span class="p">)</span>
            <span class="n">translated_right_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_right_timespan</span><span class="p">)</span>
        <span class="n">translated_left_timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">left_timespan</span> <span class="ow">in</span> <span class="n">left_timespans</span><span class="p">:</span>
            <span class="n">translated_left_timespan</span> <span class="o">=</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">translation_to_right</span><span class="p">,</span> <span class="n">translation_to_right</span>
            <span class="p">)</span>
            <span class="n">translated_left_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_left_timespan</span><span class="p">)</span>
        <span class="n">new_timespans</span> <span class="o">=</span> <span class="n">translated_right_timespans</span> <span class="o">+</span> <span class="n">translated_left_timespans</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">new_timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">round_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span> <span class="n">must_be_wellformed</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rounds offsets of timespans in list to multiples of ``multiplier``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rounds offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(3)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(rounded_timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rounds offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(5)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(rounded_timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rounds offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-5, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(</span>
<span class="sd">            ...     5,</span>
<span class="sd">            ...     anchor=abjad.Right,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, range_=(-5, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(rounded_timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rounds offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(</span>
<span class="sd">            ...     5,</span>
<span class="sd">            ...     anchor=abjad.Right,</span>
<span class="sd">            ...     must_be_wellformed=False,</span>
<span class="sd">            ...     )</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(rounded_timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(5, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">round_offsets</span><span class="p">(</span>
                <span class="n">multiplier</span><span class="p">,</span>
                <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span>
                <span class="n">must_be_wellformed</span><span class="o">=</span><span class="n">must_be_wellformed</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales timespan by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scales timespans relative to timespan list start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 14), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.scale(2)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 14), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(9, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(14, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scales timespans relative to timespan list stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-3, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.scale(2, anchor=abjad.Right)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-3, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">split_at_offset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">offset</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits timespans at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(4)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(left, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(left)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(right)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(6)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(left, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(left)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(right)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(-1)</span>

<span class="sd">            &gt;&gt;&gt; left</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; abjad.f(right)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(10, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">before_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">during_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">after_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="n">offset</span><span class="p">:</span>
                <span class="n">before_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">offset</span> <span class="o">&lt;=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="n">after_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">during_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">during_list</span><span class="p">:</span>
            <span class="n">before_timespan</span><span class="p">,</span> <span class="n">after_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">before_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">before_timespan</span><span class="p">)</span>
            <span class="n">after_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">after_timespan</span><span class="p">)</span>
        <span class="n">before_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">after_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">before_list</span><span class="p">,</span> <span class="n">after_list</span>

    <span class="k">def</span> <span class="nf">split_at_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits timespans at ``offsets``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; offsets = [-1, 3, 6, 12, 13]</span>
<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.split_at_offsets(offsets):</span>
<span class="sd">            ...     abjad.show(timespan_list, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            ...     abjad.f(timespan_list)</span>
<span class="sd">            ...</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits empty list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([])</span>
<span class="sd">            &gt;&gt;&gt; timespans.split_at_offsets(offsets)</span>
<span class="sd">            [TimespanList([])]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timespan_lists</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Offset</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">))</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">offsets</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timespan_lists</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
                <span class="n">timespan_lists</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">shards</span>
        <span class="k">return</span> <span class="n">timespan_lists</span>

    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stretches timespans by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Stretches timespans relative to timespan list start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.stretch(2)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(20, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Stretches timespans relative to arbitrary anchor:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-8, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.stretch(2, anchor=abjad.Offset(8))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-8, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(-2, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(4, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(12, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespans by ``translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Translates timespan by offset ``50``:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.translate(50)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(50, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(53, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(53, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(56, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(56, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(60, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">translate_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset_translation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset_translation</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespans by ``start_offset_translation`` and</span>
<span class="sd">        ``stop_offset_translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Translates timespan start- and stop-offsets equally:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.translate_offsets(50, 50)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(50, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(53, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(53, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(56, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(56, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(60, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Translates timespan stop-offsets only:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; _ = timespans.translate_offsets(</span>
<span class="sd">            ...     stop_offset_translation=20)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(timespans)</span>
<span class="sd">            abjad.TimespanList(</span>
<span class="sd">                [</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(0, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(23, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(3, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(26, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    abjad.Timespan(</span>
<span class="sd">                        start_offset=abjad.Offset(6, 1),</span>
<span class="sd">                        stop_offset=abjad.Offset(30, 1),</span>
<span class="sd">                        ),</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>

<span class="sd">        Operates in place and returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">start_offset_translation</span><span class="p">,</span> <span class="n">stop_offset_translation</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="c1">### EXPRESSION CONSTRUCTOR ###</span>


<span class="k">def</span> <span class="nf">timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">keywords</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes timespan or timespan expression.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; abjad.timespan(0, (1, 4))</span>
<span class="sd">        Timespan(start_offset=Offset(0, 1), stop_offset=Offset(1, 4))</span>

<span class="sd">    ..  container:: example expression</span>

<span class="sd">        &gt;&gt;&gt; expression = abjad.timespan()</span>
<span class="sd">        &gt;&gt;&gt; expression(0, (1, 4))</span>
<span class="sd">        Timespan(start_offset=Offset(0, 1), stop_offset=Offset(1, 4))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">timespan</span><span class="p">(</span><span class="o">**</span><span class="n">keywords</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expression</span>


<span class="n">_timespan_constructor</span> <span class="o">=</span> <span class="n">timespan</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Josiah Wolf Oberholtzer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>